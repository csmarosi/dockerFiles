#!/bin/bash
set -e
set -x

sudo docker images
test -n "${1}"
test -z "${2}"
imageName=${1}

#Don't know why is it needed...
xhost local:

dockerHome="${HOME}/dockerFiles/dothome"
mountDirs=''

if [[ ${imageName} == *"gui" ]]; then
    mountDirs="${mountDirs} -v /tmp/.X11-unix:/tmp/.X11-unix"
    #guiMount="${guiMount} -v /dev/dri:/dev/dri"
fi

if [[ ${imageName} == "dev"* ]]; then
    mountDirs="${mountDirs} -v ${HOME}/github_projects:${HOME}/github_projects"
fi

if [[ ${imageName} == *"and"* ]]; then
    mountDirs="${mountDirs} -v /storagetree/android/android-docker/:${HOME}/android-docker/"
fi

sudo docker run --rm -it -u=$(id -u):$(id -g) \
    -e HOME=${HOME} -e DISPLAY=${DISPLAY} -e SHELL=${SHELL} \
    -v /etc/passwd:/etc/passwd:ro \
    -v /etc/group:/etc/group:ro \
    -v ${dockerHome}/:${HOME} \
    ${mountDirs} \
    ${imageName} bash
